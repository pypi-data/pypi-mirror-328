<odoo>
    <record id="view_cs_task_form" model="ir.ui.view">
        <field name="name">view.csstructure.cs.task.form</field>
        <field name="model">project.task</field>
        <field name="inherit_id" ref="vertical_carsharing.view_cs_task_form"/>
        <field name="arch" type="xml">
            <header>
                <button name="task_service_wizard" 
                    type="object" 
                    string="Crear Servei"
                    attrs="{'invisible': [('cs_task_type', '!=', 'car')]}"
                />
            </header>
            <xpath expr="//field[@name='cs_task_type']" position="after">
                <field name="cs_task_car_id" 
                    options="{'no_quick_create':True,'no_create_edit':True}"
                    attrs="{'invisible': [('cs_task_type', '!=', 'car')]}"
                    />

                <field name="cs_task_carconfig_id" 
                    options="{'no_quick_create':True,'no_create_edit':True}" 
                    attrs="{'invisible': [('cs_task_type', '!=', 'carconfig')]}"
                    />

                <field name="cs_task_pu_id" 
                    options="{'no_quick_create':True,'no_create_edit':True}"
                    attrs="{'invisible': [('cs_task_type', '!=', 'pu')]}"
                    />

                <field name="cs_task_community_id" 
                    options="{'no_quick_create':True,'no_create_edit':True}"
                    attrs="{'invisible': [('cs_task_type', '!=', 'community')]}"
                    />
                <field name="related_service_ids" widget="many2many_list" attrs="{'invisible': [('cs_task_type', '!=', 'car')]}">
                  <tree string="Service" create="true" edit="false" delete="false" open="true">    
                    <field name="date" />
                    <field name="vehicle_id" />
                    <field name="cost_subtype_id"/>
                    <field name="related_member_id" />
                    <field name="amount" sum="Total"/>
                  </tree>
                </field>
            </xpath>
        </field>
    </record>
</odoo>

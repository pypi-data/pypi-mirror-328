export const id=16733;export const ids=[16733];export const modules={16733:(e,i,s)=>{s.r(i),s.d(i,{DialogPersonBuildingDetail:()=>u});var t=s(36312),a=(s(253),s(94438),s(15112)),r=s(77706),n=(s(56864),s(77372),s(3276)),o=(s(24284),s(28066),s(98645),s(24640),s(90431),s(32084),s(71443)),l=s(6121),d=s(55321),h=s(96477);let u=(0,t.A)([(0,r.EM)("dialog-person-building-detail")],(function(e,i){return{F:class extends i{constructor(...i){super(...i),e(this)}},d:[{kind:"field",decorators:[(0,r.MZ)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,r.wk)()],key:"_name",value:()=>""},{kind:"field",decorators:[(0,r.wk)()],key:"_userId",value:void 0},{kind:"field",decorators:[(0,r.wk)()],key:"_user",value:void 0},{kind:"field",decorators:[(0,r.wk)()],key:"_error",value:void 0},{kind:"field",decorators:[(0,r.wk)()],key:"_params",value:void 0},{kind:"field",decorators:[(0,r.wk)()],key:"_submitting",value:()=>!1},{kind:"field",decorators:[(0,r.wk)()],key:"_personExists",value:()=>!1},{kind:"field",decorators:[(0,r.wk)()],key:"_buildingUrl",value:()=>""},{kind:"field",decorators:[(0,r.wk)()],key:"_accessToken",value:()=>""},{kind:"method",key:"showDialog",value:async function(e){this._params=e,this._error=void 0,this._params.entry?(this._personExists=!0,this._name=this._params.entry.name||"",this._userId=this._params.entry.user_id||void 0,this._user=this._userId?this._params.users.find((e=>e.id===this._userId)):void 0):(this._personExists=!1,this._name="",this._userId=void 0,this._user=void 0),this._buildingUrl="",this._accessToken="",await this.updateComplete}},{kind:"method",key:"render",value:function(){if(!this._params)return a.s6;const e=""===this._name.trim();return a.qy` <ha-dialog open @closed="${this._close}" scrimClickAction escapeKeyAction .heading="${(0,n.l)(this.hass,this._params.entry?this._params.entry.name:this.hass.localize("ui.panel.config.person.detail.name"))}"> <div> ${this._error?a.qy`<div class="error">${this._error}</div>`:""} <div class="form"> <ha-textfield class="name" name="name" .value="${this._name}" @input="${this._handleValueChanged}" label="${this.hass.localize("ui.panel.config.building.name")}" required .validationMessage="${this.hass.localize("ui.common.error_required")}" dialogInitialFocus></ha-textfield> <ha-textfield class="display-name" name="buildingUrl" .value="${this._buildingUrl}" @input="${this._handleValueChanged}" label="${this.hass.localize("ui.panel.config.building.url")}" required .validationMessage="${this.hass.localize("ui.common.error_required")}"></ha-textfield> <ha-textfield class="display-name" name="accessToken" .value="${this._accessToken}" @input="${this._handleValueChanged}" label="Access Token" required .validationMessage="${this.hass.localize("ui.common.error_required")}"></ha-textfield> </div> </div> ${this._params.entry?a.qy` <ha-button slot="secondaryAction" class="warning" @click="${this._deleteEntry}" .disabled="${this._user&&this._user.is_owner||this._submitting}"> ${this.hass.localize("ui.panel.config.person.detail.delete")} </ha-button> `:a.s6} <ha-button slot="primaryAction" @click="${this._createOrUpdateEntry}" .disabled="${e||this._submitting}"> ${this._params.entry?this.hass.localize("ui.panel.config.person.detail.update"):this.hass.localize("ui.panel.config.person.detail.create")} </ha-button> </ha-dialog> `}},{kind:"method",key:"_handleValueChanged",value:function(e){this._error=void 0;const i=e.target;switch(i.name){case"name":this._name=i.value;break;case"buildingUrl":this._buildingUrl=i.value;break;case"accessToken":this._accessToken=i.value}}},{kind:"method",key:"_createOrUpdateEntry",value:async function(){const e={name:this._name,building_url:this._buildingUrl,access_token:this._accessToken};try{const i=await fetch(`${h.u}/building/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(i.ok)(0,l.showAlertDialog)(this,{title:"Building created successfully"}),this._close();else{const e=await i.json(),s=e.errors?.[0]?.message||`Failed to register building. Status: ${i.status} - ${i.statusText}`;(0,l.showAlertDialog)(this,{title:s})}}catch(e){this._error=e.message||"Unknown error",(0,l.showAlertDialog)(this,{title:`Error Creating User ${e.message}`})}}},{kind:"method",key:"_deleteEntry",value:async function(){this._submitting=!0;try{await this._params.removeEntry()&&(this._params.entry.user_id&&(0,o.hG)(this.hass,this._params.entry.user_id),this._params=void 0)}finally{this._submitting=!1}}},{kind:"method",key:"_close",value:function(){!this._personExists&&this._userId&&((0,o.hG)(this.hass,this._userId),this._params?.refreshUsers(),this._userId=void 0),this._params=void 0}},{kind:"get",static:!0,key:"styles",value:function(){return[d.nA,a.AH`ha-password-field,ha-picture-upload,ha-textfield{display:block;margin-bottom:16px}ha-picture-upload{--file-upload-image-border-radius:50%}ha-settings-row{padding:0}a{color:var(--primary-color)}.error{color:var(--error-color);margin-bottom:16px}.building-selection{margin-bottom:16px}.building-selection label{display:block;margin-bottom:4px}.building-selection select{width:100%;padding:8px;font-size:14px}`]}}]}}),a.WF)}};
//# sourceMappingURL=16733.cKIMfE7ONio.js.map
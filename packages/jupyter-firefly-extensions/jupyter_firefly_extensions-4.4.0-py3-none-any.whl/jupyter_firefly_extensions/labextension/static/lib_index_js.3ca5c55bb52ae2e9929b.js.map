{"version":3,"file":"lib_index_js.3ca5c55bb52ae2e9929b.js","mappings":"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","sources":["webpack://jupyter_firefly_extensions/./src/FireflyCommonUtils.js","webpack://jupyter_firefly_extensions/./src/FitsViewerExt.js","webpack://jupyter_firefly_extensions/./src/SlateCommandExt.js","webpack://jupyter_firefly_extensions/./src/index.ts"],"sourcesContent":["import {initFirefly} from 'firefly-api-access';\nimport { ServerConnection } from '@jupyterlab/services';\n\n\nlet cachedLoc;\nlet cachedFindFireflyResult;\nconst ffLocURL= makeLabEndpoint('lab/fireflyLocation');\nconst fetchOptions= {\n    method: 'get',\n    mode: 'cors',\n    credentials: 'include',\n    cache: 'default',\n    headers: { 'X-Requested-With': 'XMLHttpRequest' }\n};\n\n/**\n * Determine where firefly is my calling the lab server extension then load firefly.\n * Results are cache so this function can be call many times.\n * @return {Promise<{firefly: Object, channel: string, fireflyURL: string}>}\n */\nexport async function findFirefly()  {\n    if (cachedFindFireflyResult) return cachedFindFireflyResult;\n\n    try {\n        // request the config from server at /lab/fireflyLocation (see handlers.py)\n        const settings = ServerConnection.makeSettings();\n        if (!cachedLoc) cachedLoc= await (await ServerConnection.makeRequest(ffLocURL, fetchOptions, settings)).json();\n\n        // make sure that response of the above request contains non-empty fireflyURL\n        const {fireflyURL, fireflyChannel:channel, fireflyHtmlFile}= cachedLoc;\n        if (!fireflyURL) throw new Error(`fireflyURL couldn't be retrieved from ${ffLocURL}`);\n\n        // load firefly API from fireflyURL at /lab (window)\n        // (CORS errors might happen here if headers aren't set up correctly, maybe due to caching)\n        if (!window.firefly?.initialized) window.firefly= {...window.firefly, wsch:channel};\n        if (!window.getFireflyAPI) window.getFireflyAPI= initFirefly(fireflyURL);\n        const firefly= await window.getFireflyAPI();\n\n        // resolve Promise\n        cachedFindFireflyResult= {fireflyURL, channel, firefly, fireflyHtmlFile};\n        console.log('Firefly loaded successfully\\n', cachedFindFireflyResult);\n        return cachedFindFireflyResult;\n    }\n    catch (e) {\n        // log information about error(s) before rejecting Promise\n        console.group('Firefly Load Failed');\n        console.log('findFirefly: Could not determine firefly location or load firefly, call failed');\n        if (cachedLoc) console.log(`firefly url: ${cachedLoc.fireflyURL} channel: ${cachedLoc.fireflyChannel}`);\n        console.log(e);\n        console.groupEnd('Firefly Load Failed');\n        throw e;  // to let promise reject\n    }\n\n}\n\n\n\nexport function buildURLErrorHtml(e) {\n    const details= `<br>Set the firefly URL by setting <code>c.Firefly.url</code> in \n                    <code>jupyter_notebook_config.py</code>\n                    <br>or the environment variable <code>FIREFLY_URL</code>`;\n    return `<div style='padding: 30px 0 0 30px'>${e.message}${details}</div>`;\n}\n\n\nexport function makeLabEndpoint(endPoint, searchParams) {\n    const {origin,pathname}= new URL(window.document.location.href);\n    const originURL= origin + pathname;\n    const start= originURL.substring(0, originURL.lastIndexOf('lab'));\n    const slashMaybe= start.endsWith('/') ? '' : '/';\n    return `${start}${slashMaybe}${endPoint}${searchParams?'?'+searchParams.toString():''}`;\n}","import b64toBlob from 'b64-to-blob';\nimport {buildURLErrorHtml, findFirefly, makeLabEndpoint} from './FireflyCommonUtils.js';\nimport { Widget } from '@lumino/widgets';\nimport { ABCWidgetFactory, DocumentWidget} from '@jupyterlab/docregistry';\nimport { PageConfig} from '@jupyterlab/coreutils';\n\n\nexport const FITS_MIME_TYPE = 'application/fits';\n\n\n/**\n * The class name added to the extension.\n */\nconst CLASS_NAME = 'jp-OutputWidgetFITS';\n\nlet idCounter=0;\n\nconst FACTORY = 'Firefly (Image Viewer)';\n\n\nconst fitsIFileType= {\n    name: 'FITS',\n    displayName: 'FITS file',\n    fileFormat: 'base64',  // TODO: try putting a null here to keep from loading file, the might be the answer\n                           // will need to check the JL version someway\n    format: 'base64',\n    mimeTypes: [FITS_MIME_TYPE],\n    extensions: ['.fits']\n};\n\n/**\n *\n * @param {JupyterLab} app\n * @param {ILayoutRestorer} restorer\n */\nexport function activateFitsViewerExt(app, restorer) {\n    const namespace = 'firefly-imageviewer-widget';\n    const jlVersion= PageConfig.getOption('appVersion');\n    const vAry= jlVersion?.split('.').map( (x) => Number(x)) ?? [0,0,0];\n\n    // if Jupyter Lab version is 3.1 or greater then clear the fileFormat so it does not load the file on the client\n    // see - https://github.com/jupyterlab/jupyterlab/pull/7596\n    if (vAry[0] >=3 && vAry[1] >= 1) fitsIFileType.fileFormat= null;\n\n    app.docRegistry.addFileType(fitsIFileType);\n    const factory = new ABCWidgetFactory({\n        name: FACTORY,\n        modelName: 'base64',\n        // modelName: 'fits-model',\n        fileTypes: ['FITS'],\n        defaultFor: ['FITS'],\n        readOnly: true\n    });\n    factory.createNewWidget= createNewFitsViewerDocumentWidget;\n    app.docRegistry.addWidgetFactory(factory);\n\n    factory.widgetCreated.connect((sender, widget) => {\n        const types = app.docRegistry.getFileTypesForPath(widget.context.path);\n\n        if (types.length) {\n            widget.title.iconClass = types[0].iconClass || '';\n            widget.title.iconLabel = types[0].iconLabel || '';\n        }\n    });\n}\n\n\n\n\n\nexport function createNewFitsViewerDocumentWidget(context) {\n    // instead of extending DocumentWidget like the example, just use it directly\n    return new DocumentWidget({ content:new FitsViewerWidget(context), context, reveal:true, toolbar:null });\n}\n\n/**\n * A widget for rendering FITS.\n */\nexport class FitsViewerWidget extends Widget {\n    /**\n     * Construct a new output widget.\n     * @param context\n     */\n    constructor(context) {\n        super({ node: createNode(context._path) });\n        const useModel= window.firefly && window.firefly.jlExtUseModel || false;\n        this.addClass(CLASS_NAME);\n        this.filename= context._path;\n        idCounter++;\n        this.plotId= `${this.filename}-${idCounter}`;\n        this.loaded= false;\n        if (this.isDisposed) return;\n        this.renderModel(context,useModel).then(() => {\n        });\n        context.model.contentChanged.connect( this.renderModel, this );\n        context.fileChanged.connect( this.renderModel, this );\n    }\n\n    /**\n     * Render FITS into this widget's node.\n     * @param context\n     * @param useModelFirst\n     * @return {Promise<{firefly: Object, channel: string, fireflyURL: string}>}\n     */\n    renderModel(context, useModelFirst) {\n\n        if (this.isDisposed) return;\n\n        if (this.loaded) {\n            return findFirefly()\n                .then( (ffConfig) => ffConfig.firefly.action.dispatchChangeActivePlotView(this.plotId) );\n        }\n\n        let firefly, fireflyURL;\n        return findFirefly()\n            .then( (ffConfig) => {\n                firefly= ffConfig.firefly;\n                fireflyURL= ffConfig.fireflyURL;\n                if (useModelFirst) {\n                    return context.ready.then(() => loadFileToServer(context.model.toString(), this.filename, firefly, fireflyURL));\n                }\n                else {\n                    return tellLabToLoadFileToServer(this.filename, firefly);\n                }\n            } )\n            .then( (response) => response.text())\n            .then( (text) => {\n                if (useModelFirst) {\n                    const [, cacheKey] = text.split('::::');\n                    showImage(cacheKey,this.plotId, this.filename, firefly);\n                }\n                else {\n                    if (text && text.length<300 && text.startsWith('${')) {\n                        showImage(text,this.plotId, this.filename, firefly);\n                    }\n                    else {\n                        console.log('Firefly FitsViewExt: Failed to upload from server, ' +\n                                          'falling back to (slower) browser upload.');\n                        context.ready.then(() => loadFileToServer(context.model.toString(), this.filename, firefly, fireflyURL))\n                            .then( (response) => response.text())\n                            .then( (text) => {\n                                const [, cacheKey] = text.split('::::');\n                                showImage(cacheKey, this.plotId, this.filename, firefly);\n                            });\n                    }\n                }\n                this.loaded= true;\n            })\n            .catch( (e) => {\n                const div= document.getElementById(this.filename);\n                if (div) div.innerHTML=buildURLErrorHtml(e);\n            });\n    }\n\n    dispose() {\n        return findFirefly()\n            .then( (ffConfig) => ffConfig.firefly.action.dispatchDeletePlotView({plotId:this.plotId, holdWcsMatch:true}) );\n\n    }\n\n    activate() {\n        super.activate();\n        if (this.loaded) {\n            return findFirefly().then( (ffConfig) => ffConfig.firefly.action.dispatchChangeActivePlotView(this.plotId) );\n        }\n    }\n}\n\n\nfunction tellLabToLoadFileToServer( path, firefly) {\n    const url= makeLabEndpoint('lab/sendToFirefly', new URLSearchParams({'path':path}));\n    return firefly.util.fetchUrl(url,{ method: 'GET' },false, false)\n        .catch( (e) => {\n            console.error('Firefly FitsViewExt: Got Error from upload request',e);\n            return 'FAILED';\n        });\n}\n\n\nfunction loadFileToServer( fileData, filename, firefly, fireflyURL) {\n    const {fetchUrl, ServerParams}= firefly.util;\n    const UL_URL = `${fireflyURL}/sticky/CmdSrv?${ServerParams.COMMAND}=${ServerParams.UPLOAD}&filename=${filename}`;\n    const fitsBlob= b64toBlob(fileData);\n    const options = { method: 'multipart', params: { filename, type:'FITS', file: fitsBlob } };\n    return fetchUrl(UL_URL, options);\n}\n\nfunction showImage(cacheKey, plotId, filename, firefly) {\n    const req= {\n        type     : 'FILE',\n        FILE     : cacheKey,\n        plotId,\n        plotGroupId: 'JUPLAB',\n        title: filename\n    };\n    firefly.action.dispatchApiToolsView(true, false);\n    firefly.setGlobalPref({imageDisplayType: 'encapusulate'});\n    firefly.showImage(filename, req, null, false);\n}\n\nfunction createNode(filename) {\n    const node = document.createElement('div');\n    node.id= filename;\n    return node;\n}\n\n//=========================================================================================================\n//============ Keep code below for reference\n//============ Keep code below for reference\n//============ Keep code below for reference\n\n\n// /**\n//  * A mime renderer factory for FITS data.\n//  */\n// export const fitsViewerRendererFactory = {\n//     safe: true,\n//     mimeTypes: [FITS_MIME_TYPE],\n//     createRenderer: options => {\n//         return new FitsViewerWidget (options);\n//     }\n// };\n\n\n\n// import { ABCWidgetFactory, DocumentRegistry, DocumentWidget, IDocumentWidget } from '@jupyterlab/docregistry';\n// import { PageConfig, URLExt } from '@jupyterlab/coreutils';\n\n\n// const ERROR_MSG_CONT= `Make sure you set the firefly URL in your jupyter_notebook_config.py.\n//                 For example- 'c.Firefly.url= http://some.firefly.url/firefly'`;\n\n// for adding a second extension for a mime type - does not work yet in Jupyter Lab\n// --- https://github.com/jupyterlab/jupyterlab/issues/5381\n// export const fitsViewerRendererFactory2 = {\n//     safe: true,\n//     mimeTypes: [FITS_MIME_TYPE],\n//     createRenderer: options => {\n//         return new FitsViewerWidget (options);\n//     }\n// };\n\n\n// export class FitsViewerDocument extends DocumentWidget {\n//\n//   constructor(context) {\n//       super({ content:new FitsViewerWidget(context), context, reveal:true, toolbar:null });\n//     // const toolbar = Private.createToolbar(content.viewer);\n//     // const reveal = content.ready;\n//   }\n// }\n\n\n// export class FitsViewerFactory extends ABCWidgetFactory {\n//\n//     constructor(options) {\n//         super(options);\n//     }\n//\n//\n//\n//     /**\n//      * Create a new widget given a context.\n//      * @param context DocumentRegistry.IContext<DocumentRegistry.IModel>\n//      * @return DocumentWidget\n//      */\n//     createNewWidget(context) {\n//         // return new FitsViewerDocument(context);\n//         return new DocumentWidget({ content:new FitsViewerWidget(context), context, reveal:true, toolbar:null });\n//     }\n// }\n\n\n// const a= {\n//     name: 'some-name',\n//     fileTypes: ['csv'],\n//     defaultFor: [],\n//     defaultRendered: [],\n//     readOnly: false,\n//     modelName: 'text',\n//     preferKernel: false,\n//     canStartKernel: false,\n//     widgetCreated: new Signal(null),\n// }\n","import { Widget } from '@lumino/widgets';\nimport { ICommandPalette } from '@jupyterlab/apputils';\nimport { JupyterFrontEnd } from '@jupyterlab/application';\nimport { ILauncher } from '@jupyterlab/launcher';\nimport { LabIcon } from '@jupyterlab/ui-components';\nimport { set } from 'lodash';\n\nimport { findFirefly } from './FireflyCommonUtils.js';\nimport fireflyIconStr from '../style/fftools-logo.svg';\n\n\nlet widgetId;\nconst TAB_ID= 'firefly-viewer-tab-id';\n\n/**\n * Extension can be started in two ways.\n * 1. as a jupyter command\n * 2. firefly_client sending a 'StartLabWindow' action\n * @param {JupyterFrontEnd} app\n * @param {ICommandPalette} palette\n * @param {ILauncher | null} launcher\n */\nexport function activateSlateCommandExt(app, palette, launcher) {\n    findFirefly().then( (ffConfig) => {\n        const {firefly}= ffConfig;\n        firefly.util.addActionListener(['StartLabWindow'], (action) => {\n            openSlateSingleOnly(app, TAB_ID, action.payload?.fireflyHtmlFile);\n        });\n        firefly.util.addActionListener(['StartBrowserTab'], (action) => {\n            firefly.setViewerConfig(firefly.ViewerType.Grid);\n            firefly.getViewer(action.payload.channel).openViewer();\n        });\n\n    });\n\n    // for starting extension as a jupyter command -----------\n    const command = 'firefly:open-slate';\n    const category = 'Firefly';\n    const icon = new LabIcon({\n        name: 'jupyter_firefly_extensions:firefly-icon',\n        svgstr: fireflyIconStr\n      }); \n\n    app.commands.addCommand(command, {\n        label: 'Open Firefly',\n        caption: 'Open Firefly',\n        icon,\n        isEnabled: () => true,\n        execute: () => {\n            openSlateSingleOnly(app,TAB_ID);\n        }\n    });\n\n    palette.addItem({ command, category });\n    if (launcher) launcher.add({ command, category});\n}\n\n\n/**\n * Open only one slate tab.  Using this keeps the tab as a singleton.\n * @param app\n * @param id\n * @param firelfyHtmlFile\n */\nfunction openSlateSingleOnly(app, id, firelfyHtmlFile) {\n    if (!widgetId) {\n        const widget = new SlateRootWidget(id, firelfyHtmlFile);\n        widgetId= widget.id;\n        if (app.shell.addToMainArea) app.shell.addToMainArea(widget); // --- pre version 1\n        else if (app.shell.add) app.shell.add(widget, 'main');  // version 1\n        else throw Error('Could not add firefly to tab');\n\n        findFirefly().then( (ffConfig) => {\n            const {action}= ffConfig.firefly;\n            action.dispatchChangeActivePlotView(undefined);\n        });\n    }\n    app.shell.activateById(widgetId);\n}\n\nexport class SlateRootWidget extends Widget {\n    /**\n     * Construct a new output widget.\n     */\n    constructor(id,fireflyHtmlFile) {\n        super({node: createNode(id)});\n        this.id= id;\n        this.title.label= 'Firefly Viewer';\n        this.title.closable= true;\n        findFirefly().then( (ffConfig) => {\n            this.startViewer(ffConfig.firefly, id, ffConfig.fireflyURL, fireflyHtmlFile ?? ffConfig.fireflyHtmlFile);\n        } );\n    }\n\n    startViewer(firefly, id, fireflyURL, fireflyHtmlFile) {\n        const {util,action}= firefly;\n        const props=  {\n            div: id,\n            renderTreeId: id,\n            template: fireflyHtmlFile==='slate.html' ? 'FireflySlate' : 'FireflyViewer',\n            disableDefaultDropDown: true,\n        };\n        const fallbackMenu= [\n            {label:'Images', action:'ImageSelectDropDownSlateCmd'},\n            {label:'TAP Searches', action: 'TAPSearch'},\n            {label:'Catalogs', action:'IrsaCatalogDropDown'},\n            {label:'Charts', action:'ChartSelectDropDownCmd'},\n            {label:'Upload', action: 'FileUploadDropDownCmd'},\n        ];\n        if (!firefly.originalAppProps) {\n            props.menu= fallbackMenu;\n        }\n        if (fireflyURL.endsWith('irsaviewer')) {\n            // unset the appIcon styles that irsaviewer applies for its double banner layout\n            set(props,'slotProps.banner.slotProps.tabs.pl', 0);\n            set(props,'slotProps.banner.slotProps.icon.style.marginTop', 0);\n            set(props,'slotProps.banner.slotProps.icon.sx', \n                {'.MuiSvgIcon-root': {height: '3rem', width: '3rem', pl: 0}});\n        }\n        action.dispatchApiToolsView(true,false);\n        this.controlApp= util.startAsAppFromApi(id, props);\n    }\n\n    dispose() {\n        widgetId= undefined;\n    }\n    close() {\n        super.close();\n        widgetId= undefined;\n        if (this.controlApp) this.controlApp.unrender();\n        this.controlApp= undefined;\n    }\n\n    activate() {\n        super.activate();\n        if (this.controlApp) {\n            this.controlApp.unrender();\n            this.controlApp.render();\n        }\n        findFirefly().then( (ffConfig) => {\n            const {action}= ffConfig.firefly;\n            action.dispatchChangeActivePlotView(undefined);\n        });\n    }\n}\n\n\nfunction createNode(filename) {\n    const node = document.createElement('div');\n    node.id= filename;\n    const tmpElement=  document.createElement('div');\n    tmpElement.innerHTML= '<div>Firefly Loading...</div>';\n    node.appendChild(tmpElement);\n    return node;\n}\n","import { JupyterFrontEndPlugin, ILayoutRestorer } from '@jupyterlab/application';\nimport { ICommandPalette } from '@jupyterlab/apputils';\nimport { ILauncher } from '@jupyterlab/launcher';\n\n\nimport { activateSlateCommandExt } from './SlateCommandExt.js';\nimport { activateFitsViewerExt } from './FitsViewerExt.js';\n\n/**\n * Initialization data for each extension.\n */\nconst showSlateExt: JupyterFrontEndPlugin<void> = {\n  id: 'jupyter_firefly_extensions:showSlate',\n  description: 'Show firefly slate',\n  autoStart: true,\n  requires: [ICommandPalette],\n  optional: [ILauncher],\n  activate: activateSlateCommandExt\n};\n\nconst fitsViewerExt: JupyterFrontEndPlugin<void> = {\n  id: 'jupyter_firefly_extensions:fitsviewer',\n  description: 'View a FITS file',\n  autoStart: true,\n  requires: [ILayoutRestorer],\n  activate: activateFitsViewerExt\n};\n\n// More than one extension/plugin can be exported as a list\nexport default [showSlateExt, fitsViewerExt];\n"],"names":[],"sourceRoot":""}
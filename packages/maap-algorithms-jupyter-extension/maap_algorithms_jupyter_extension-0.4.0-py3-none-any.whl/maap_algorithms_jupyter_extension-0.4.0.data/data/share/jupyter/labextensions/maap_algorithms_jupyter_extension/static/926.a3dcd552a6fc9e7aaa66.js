"use strict";(self.webpackChunkmaap_algorithms_jupyter_extension=self.webpackChunkmaap_algorithms_jupyter_extension||[]).push([[926],{1915:(e,t,a)=>{a.r(t),a.d(t,{default:()=>be});var n=a(2036),l=a(1655);const r={EXTENSION_CSS_CLASSNAME:"jl-ReactAppWidget",VIEW_ALGORITHMS_PLUGIN_ID:"view_algorithms:plugin",VIEW_ALGORITHMS_NAME:"View Algorithms",VIEW_ALGORITHMS_OPEN_COMMAND:"view_algorithms:open",REGISTER_ALGORITHM_PLUGIN_ID:"register_algorithm:plugin",REGISTER_ALGORITHM_NAME:"Register Algorithm",REGISTER_ALGORITHM_OPEN_COMMAND:"register_algorithm:open",SUBMIT_JOBS_OPEN_COMMAND:"jobs_submit:open"},o="inputName",i="inputDefault",s="inputDesc",c="isRequired",m="inputId";var d=a(9198),u=a(5256),p=a(3345),g=a.n(p),h=a(2209),E=a(678),f=a(9033);const v={positionalData:[],configData:[],fileData:[],repoUrl:"",repoBranch:"",repoRunCommand:"",repoBuildCommand:"",algoName:"",algoDesc:"",algoDiskSpace:"",algoResource:"",algoContainer:"",inputId:0,registrationUrl:"",algorithmRegistrationError:"",algorithmYmlFilePath:""},w=(0,f.createSlice)({name:"Algorithm",initialState:v,reducers:{resetValue:()=>v,setRegistrationUrl:(e,t)=>{e.registrationUrl=t.payload},setAlgorithmRegistrationError:(e,t)=>{e.algorithmRegistrationError=t.payload},setAlgorithmYmlFilePath:(e,t)=>{e.algorithmYmlFilePath=t.payload},incrementInputId:e=>{e.inputId=e.inputId+1},setRepoUrl:(e,t)=>{e.repoUrl=t.payload},setRepoBranch:(e,t)=>{e.repoBranch=t.payload},setRepoRunCommand:(e,t)=>{e.repoRunCommand=t.payload},setRepoBuildCommand:(e,t)=>{e.repoBuildCommand=t.payload},setAlgoName:(e,t)=>{e.algoName=t.payload},setAlgoDesc:(e,t)=>{e.algoDesc=t.payload},setAlgoDiskSpace:(e,t)=>{e.algoDiskSpace=t.payload},setAlgoResource:(e,t)=>{e.algoResource=t.payload},setAlgoContainerURL:(e,t)=>{e.algoContainer=t.payload},addConfigData:(e,t)=>{e.configData=[...e.configData,t.payload]},updateConfigData:(e,t)=>({...e,configData:e.configData.map((e=>e.inputId==t.payload.inputId?{...e,[t.payload.inputField]:t.payload.inputValue}:e))}),removeConfigData:(e,t)=>{let a=[...e.configData];return a.map(((e,n)=>{e.inputId==t.payload.key&&a.splice(n,1)})),{...e,configData:a}},addFileData:(e,t)=>{e.fileData=[...e.fileData,t.payload]},updateFileData:(e,t)=>({...e,fileData:e.fileData.map((e=>e.inputId==t.payload.inputId?{...e,[t.payload.inputField]:t.payload.inputValue}:e))}),removeFileData:(e,t)=>{let a=[...e.fileData];return a.map(((e,n)=>{e.inputId==t.payload.key&&a.splice(n,1)})),{...e,fileData:a}},addPositionalData:(e,t)=>{e.positionalData=[...e.positionalData,t.payload]},updatePositionalData:(e,t)=>({...e,positionalData:e.positionalData.map((e=>e.inputId==t.payload.inputId?{...e,[t.payload.inputField]:t.payload.inputValue}:e))}),removePositionalData:(e,t)=>{let a=[...e.positionalData];return a.map(((e,n)=>{e.inputId==t.payload.key&&a.splice(n,1)})),{...e,positionalData:a}}}}),A=w.actions,y=e=>e.Algorithm,x=w.reducer,_={algorithmsList:[],algorithmsData:[],selectedAlgorithm:{id:"",description:"",inputs:[]}},R=(0,f.createSlice)({name:"RegisteredAlgorithms",initialState:_,reducers:{resetValue:()=>_,setAlgorithmsList:(e,t)=>{e.algorithmsList=t.payload},setAlgorithmsData:(e,t)=>{e.algorithmsData=t.payload},setSelectedAlgorithm:(e,t)=>{e.selectedAlgorithm=t.payload,console.log(e.selectedAlgorithm)}}}),I=R.actions,N=e=>e.RegisteredAlgorithms,C=R.reducer,S={rowCount:10},D=(0,f.createSlice)({name:"SplitPane",initialState:S,reducers:{resetValue:()=>S,updateSize:(e,t)=>{e.rowCount=t.payload}}}),b=D.actions,M=e=>e.SplitPane,k=D.reducer,P=(0,f.configureStore)({reducer:{Algorithm:x,RegisteredAlgorithms:C,SplitPane:k},devTools:!0});a(7452);var O=a(298),T=a(1700),L=a(5072),B=a.n(L),j=a(7825),G=a.n(j),U=a(7659),F=a.n(U),V=a(5056),H=a.n(V),z=a(540),q=a.n(z),W=a(1113),J=a.n(W),K=a(5443),Y={};Y.styleTagTransform=J(),Y.setAttributes=H(),Y.insert=F().bind(null,"head"),Y.domAPI=G(),Y.insertStyleElement=q(),B()(K.A,Y),K.A&&K.A.locals&&K.A.locals;const $=({jupyterApp:e})=>g().createElement("div",{className:"action-bar"},g().createElement(T.Button,{variant:"primary",onClick:()=>((e,t)=>{console.log("in open registration"),console.log(t),e.commands.hasCommand(r.REGISTER_ALGORITHM_OPEN_COMMAND)&&(console.log("opening registration to edit"),console.log("in null"),e.commands.execute(r.REGISTER_ALGORITHM_OPEN_COMMAND,null))})(e,null)},"+ New Algorithm"));var X=a(854),Q=a(5310);const Z=e=>{let t={id:"",description:"",inputs:[]};return e=JSON.parse(e),t.id=(e=>e["wps:ProcessOfferings"]["wps:ProcessOffering"]["wps:Process"]["ows:Identifier"])(e),t.description=(e=>e["wps:ProcessOfferings"]["wps:ProcessOffering"]["wps:Process"]["ows:Title"])(e),t.inputs=(e=>{let t=[];return e["wps:ProcessOfferings"]["wps:ProcessOffering"]["wps:Process"]["wps:Input"].forEach((e=>{let a={id:"",title:"",maxOccurs:"",minOccurs:"",dataType:"",required:"",defaultValue:""};a.id=e["ows:Identifier"],a.title=e["ows:Title"],a.required=e["ns:LiteralData"]["ns:Format"]["@default"],a.minOccurs=e["@minOccurs"],a.maxOccurs=e["@maxOccurs"],a.defaultValue=e["ns:LiteralData"].LiteralDataDomain["ows:AnyValue"];try{a.dataType=e["ns:LiteralData"].LiteralDataDomain["ows:DataType"]["@ows:reference"]}catch{a.dataType=""}t.push(a)})),t})(e),t};async function ee(e,t){var a=[],n=new URL(Q.PageConfig.getBaseUrl()+"jupyter-server-extension/getQueues");return await fetch(n.href,{headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((n=>{n.response.forEach((e=>{let t={};t.value=e,t.label=e,a.push(t)}));const l=((e,t)=>{const a=t.toLowerCase();return e.filter((({label:e})=>e.toLowerCase().includes(a)))})(a,e);return t(l),a})),a}async function te(){var e=[],t=new URL(Q.PageConfig.getBaseUrl()+"jupyter-server-extension/getWorkspaceContainer");console.log(t.href);try{const a=await fetch(t.href,{headers:{"Content-Type":"application/json"}});if(!a.ok)throw new Error("Request failed");console.log("resolved");const n=await a.json();console.log(n),Object.entries(n).forEach((([t,a])=>{let n={};n.value=a,n.label=a,e.push(n)}));let l=n.DOCKERIMAGE_PATH_DEFAULT;return P.dispatch(w.actions.setAlgoContainerURL({value:l,label:l})),e}catch(e){console.log("error in new endpoint"),console.log(e)}}function ae({column:{filterValue:e,preFilteredRows:t,setFilter:a,columns:n}}){return g().createElement("input",{value:e||"",onChange:e=>{a(e.target.value||void 0)},placeholder:"Search..."})}function ne({columns:e,data:t,jupyterApp:a}){const n=(0,E.useDispatch)(),{setSelectedAlgorithm:l}=I,{rowCount:o}=(0,E.useSelector)(M),{algorithmsList:i}=(0,E.useSelector)(N),[s,c]=(0,p.useState)(null),[m,d]=(0,p.useState)(!1),[u,h]=(0,p.useState)(""),[f,v]=(0,p.useState)(!1),w=e=>{c(e)},A=()=>d(!1),y=g().useMemo((()=>({Filter:ae})),[]);(0,p.useEffect)((()=>{U(o)}),[o]),(0,p.useEffect)((()=>{v(!0),async function(){try{const e=await async function(){const e=[];var t=new URL(Q.PageConfig.getBaseUrl()+"jupyter-server-extension/describeAlgorithms");const a=P.getState().RegisteredAlgorithms.algorithmsList;for(const n of a){let a={id:"",description:"",inputs:[]};try{t.searchParams.append("algo_id",n);const l=await fetch(t.href,{headers:{"Content-Type":"application/json"}}),r=await l.json();console.log("Data from api return"),console.log(r),a=Z(r.response),console.log(a),e.push(a)}catch(e){console.error(`Error fetching data: ${e}`)}}return e}();console.log("All responses:",e),P.dispatch(I.setAlgorithmsData(e))}catch(e){console.error("Error fetching data:",e)}}().finally((()=>v(!1)))}),[i]);const{getTableProps:x,getTableBodyProps:_,headerGroups:R,rows:C,canPreviousPage:S,canNextPage:D,prepareRow:b,pageOptions:k,pageCount:L,gotoPage:B,nextPage:j,previousPage:G,setPageSize:U,state:{pageIndex:F,pageSize:V}}=(0,O.useTable)({defaultColumn:y,columns:e,data:t,initialState:{pageIndex:0,pageSize:o}},O.useFilters,O.usePagination);return g().createElement(g().Fragment,null,g().createElement(T.Table,{...x(),className:"hover"},g().createElement("thead",null,R.map((e=>g().createElement("tr",{...e.getHeaderGroupProps()},e.headers.map((e=>g().createElement("th",{...e.getHeaderProps()},e.render("Header"),g().createElement("div",null,e.canFilter?e.render("Filter"):null)))))))),g().createElement("tbody",{..._()},f?g().createElement("tr",null,g().createElement("td",{colSpan:e.length,style:{textAlign:"center"}},g().createElement(T.Spinner,{animation:"border",variant:"primary"}))):C.map(((e,t)=>{b(e);const o=t===s;return g().createElement("tr",{...e.getRowProps(),onClick:()=>(e=>{const t=e.original;console.log("Data: ",t),n(l(t))})(e),onMouseEnter:()=>w(t),onMouseLeave:()=>w(null),className:o?"hovered":""},e.cells.map((e=>g().createElement("td",{...e.getCellProps()},e.render("Cell")))),o?g().createElement("td",{className:"row-actions"},g().createElement(X.i8P,{color:"green",size:18,title:"Run",onClick:()=>((e,t)=>{console.log("in open jobs"),console.log(e.commands),e.commands.hasCommand(r.SUBMIT_JOBS_OPEN_COMMAND)&&(console.log("jobs command exists"),null==t?(console.log("in null"),e.commands.execute(r.SUBMIT_JOBS_OPEN_COMMAND)):(console.log("in data"),e.commands.execute(r.SUBMIT_JOBS_OPEN_COMMAND)))})(a,e)}),g().createElement(X.J8m,{color:"red",size:16,title:"Unregister",onClick:()=>(e=>{h(e.values.id),d(!0)})(e)})):g().createElement("td",null))})))),g().createElement("div",{className:"pagination-footer"},g().createElement("span",null,"Showing ",0===k.length?0:F+1," of ",k.length),g().createElement(T.Pagination,null,g().createElement(T.Pagination.First,{onClick:()=>B(0),disabled:!S}),g().createElement(T.Pagination.Prev,{onClick:()=>G(),disabled:!S}),g().createElement(T.Pagination.Next,{onClick:()=>j(),disabled:!D}),g().createElement(T.Pagination.Last,{onClick:()=>B(L-1),disabled:!D}))),g().createElement(T.Modal,{show:m,onHide:A,centered:!0},g().createElement(T.Modal.Header,{closeButton:!0},g().createElement(X.qVV,{color:"red",size:30,className:"margin-right-1"})),g().createElement(T.Modal.Body,null,"Are you sure you want to unregister ",g().createElement("i",null,u)," ?"),g().createElement(T.Modal.Footer,null,g().createElement(T.Button,{variant:"secondary",onClick:A},"Cancel"),g().createElement(T.Button,{variant:"danger",onClick:()=>{(async function(e){return new URL(Q.PageConfig.getBaseUrl()+"jupyter-server-extension/unregisterAlgorithm").searchParams.append("algo_id",e),console.log("unregister algorithm"),""})(u).finally((()=>{console.log("unregistered return")}))}},"Unregister"))))}const le=({jupyterApp:e})=>{const{algorithmsData:t}=(0,E.useSelector)(N),a=(0,p.useMemo)((()=>t),[t]),n=(0,p.useMemo)((()=>[{Header:"Algorithm ID",accessor:"id"}]),[]);return g().createElement("div",null,g().createElement($,{jupyterApp:e}),g().createElement(ne,{columns:n,data:a,jupyterApp:e}))};a(6378);var re=a(4853),oe=a.n(re);const ie=()=>{const{selectedAlgorithm:e}=(0,E.useSelector)(N);return g().createElement("div",{className:"job-details-container"},g().createElement("h2",null,"Algorithm Details"),g().createElement(T.Tab.Container,{id:"left-tabs-example",defaultActiveKey:"general"},g().createElement(T.Nav,{variant:"pills",className:"nav-menu"},g().createElement(T.Nav.Item,null,g().createElement(T.Nav.Link,{eventKey:"general"},"General")),g().createElement(T.Nav.Item,null,g().createElement(T.Nav.Link,{eventKey:"inputs"},"Inputs"))),g().createElement(T.Tab.Content,{className:"content-padding"},g().createElement(T.Tab.Pane,{eventKey:"general"}),g().createElement(T.Tab.Pane,{eventKey:"inputs"},g().createElement("table",null,g().createElement("thead",null,g().createElement("tr",null,g().createElement("th",null,"ID"),g().createElement("th",null,"Data Type"),g().createElement("th",null,"Default Value"),g().createElement("th",null,"Required?"))),g().createElement("tbody",null,e?e.inputs.map((e=>(console.log("iterating over inputs"),console.log(e),g().createElement("tr",null,g().createElement("td",null,e.id),g().createElement("td",null,e.dataType),g().createElement("td",null,e.defaultValue),g().createElement("td",null,e.required))))):g().createElement("i",null,'"No algorithm selected"')))))))},se=({jupyterApp:e})=>{const t=(0,E.useDispatch)(),{updateSize:a}=b;(0,p.useEffect)((()=>{!async function(){let e=[],t=[];var a=new URL(Q.PageConfig.getBaseUrl()+"jupyter-server-extension/listAlgorithms");a.searchParams.append("visibility","all"),await fetch(a.href,{headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((a=>(a.response.algorithms.forEach((e=>{t.push(e.type+":"+e.version)})),console.log("list from api: ",t),P.dispatch(I.setAlgorithmsList(t)),e)))}()}),[]);let n={split:"horizontal",defaultSize:200,primary:"first",onChange:e=>(e=>{console.log("Sizes: "),console.log(e);let n=Math.floor(e[0]/4e3)-1;n<1&&(n=1),console.log(n),t(a(n))})(e),pane1Style:{position:"relative"}};return g().createElement(oe(),{...n},g().createElement(oe(),null,g().createElement(le,{jupyterApp:e})),g().createElement(oe(),null,g().createElement(ie,null)))};var ce=a(9966),me=a(9363),de=a(7831),ue=a(4513);const pe=({row:e,handleRemoveRow:t,handleDataChange:a})=>g().createElement(ue.A,{id:e.inputId.toString()},g().createElement(de.A,null," "),g().createElement(de.A,null,g().createElement(ce.A,{id:o,placeholder:"What is the input name?",size:"small",onChange:a,value:e.inputName,sx:{width:"35ch"}})),g().createElement(de.A,null,g().createElement(ce.A,{id:s,placeholder:"Describe the input parameter",size:"small",onChange:a,value:e.inputDesc,sx:{width:"35ch"}})),g().createElement(de.A,null,g().createElement(me.A,{id:c,name:"required",onChange:a,checked:e.isRequired})),g().createElement(de.A,null,g().createElement(ce.A,{id:i,placeholder:"Default value",size:"small",onChange:a,value:e.inputDefault,sx:{width:"25ch"}})),g().createElement(de.A,null,g().createElement(X.wrV,{className:"danger-icon",id:e.inputId.toString(),onClick:()=>t(e.inputId.toString())})));var ge=a(9482),he=a(3110),Ee=a(5017),fe=a(2862),ve=a(2499),we=a(8702);const Ae=()=>{const e=(0,E.useDispatch)(),{fileData:t,inputId:a}=(0,E.useSelector)(y),{addFileData:n,updateFileData:l,removeFileData:r,incrementInputId:d}=A,u=t=>{"checkbox"===t.target.type?e(l({inputId:t.target.parentNode.parentNode.parentNode.parentNode.id,inputField:[t.target.id],inputValue:t.target.checked})):e(l({inputId:t.target.parentNode.parentNode.parentNode.parentNode.id,inputField:[t.target.id],inputValue:t.target.value}))},p=t=>{e(r({key:t}))};return g().createElement("div",null,g().createElement("div",{className:"input-types"},g().createElement("h4",null,"File Inputs"),g().createElement(ge.Tooltip,{anchorId:"file_input_info",place:"right",variant:"dark",content:"Inputs defined here will be downloaded and placed in a directory named 'inputs'."}),g().createElement("span",{id:"file_input_info"},g().createElement(X.u7w,null))),g().createElement("div",{style:{display:"flex",alignItems:"left"}},g().createElement(Ee.A,{component:fe.A},g().createElement(he.A,{"aria-label":"simple table",sx:{border:"none"}},g().createElement(we.A,null,g().createElement(ue.A,null,g().createElement(de.A,{align:"left"},g().createElement(X.b0y,{className:"success-icon",onClick:()=>{e(n({[o]:"",[i]:"",[s]:"",[c]:!1,[m]:a})),e(d())}})),g().createElement(de.A,{align:"left",sx:{fontSize:"16px"}},"Name"),g().createElement(de.A,{align:"left",sx:{fontSize:"16px"}},"Description"),g().createElement(de.A,{align:"left",sx:{fontSize:"16px"}},"Required?"),g().createElement(de.A,{align:"left",sx:{fontSize:"16px"}},"Default Value"),g().createElement(de.A,null))),g().createElement(ve.A,null,0==t.length?g().createElement(ue.A,null,g().createElement(de.A,{colSpan:6,align:"center",className:"empty-row",sx:{fontSize:"16px"}},"No inputs specified")):Object.entries(t).map((([e,t])=>g().createElement(pe,{row:t,handleRemoveRow:p,handleDataChange:u}))))))))},ye=()=>{const e=(0,E.useDispatch)(),{positionalData:t,inputId:a}=(0,E.useSelector)(y),{addPositionalData:n,updatePositionalData:l,removePositionalData:r,incrementInputId:d}=A,u=t=>{"checkbox"===t.target.type?e(l({inputId:t.target.parentNode.parentNode.parentNode.parentNode.id,inputField:[t.target.id],inputValue:t.target.checked})):e(l({inputId:t.target.parentNode.parentNode.parentNode.parentNode.id,inputField:[t.target.id],inputValue:t.target.value}))},p=t=>{e(r({key:t}))};return g().createElement("div",null,g().createElement("div",{className:"input-types"},g().createElement("h4",null,"Positional Inputs"),g().createElement(ge.Tooltip,{anchorId:"positional_input_info",place:"right",variant:"dark",content:"Inputs defined here will be used as inputs to the run command defined as                            run_command. The order in which the inputs are defined will be preserved                            when building the run_command. It is recommended that positional inputs                             be used when users wish to change the behavior of the run command                            and not the behavior of the algorithm e.g. adding a verbose flag."}),g().createElement("span",{id:"positional_input_info"},g().createElement(X.u7w,null))),g().createElement("div",{style:{display:"flex",alignItems:"left"}},g().createElement(Ee.A,{component:fe.A},g().createElement(he.A,{"aria-label":"simple table",sx:{border:"none"}},g().createElement(we.A,null,g().createElement(ue.A,null,g().createElement(de.A,{align:"left"},g().createElement(X.b0y,{className:"success-icon",onClick:()=>{e(n({[o]:"",[i]:"",[s]:"",[c]:!1,[m]:a})),e(d())}})),g().createElement(de.A,{align:"left",sx:{fontSize:"16px"}},"Name"),g().createElement(de.A,{align:"left",sx:{fontSize:"16px"}},"Description"),g().createElement(de.A,{align:"left",sx:{fontSize:"16px"}},"Required?"),g().createElement(de.A,{align:"left",sx:{fontSize:"16px"}},"Default Value"),g().createElement(de.A,null))),g().createElement(ve.A,null,0==t.length?g().createElement(ue.A,null,g().createElement(de.A,{colSpan:6,align:"center",className:"empty-row",sx:{fontSize:"16px"}},"No inputs specified")):Object.entries(t).map((([e,t])=>g().createElement(pe,{row:t,handleRemoveRow:p,handleDataChange:u}))))))))};var xe=a(1769),_e=a.n(xe);function Re(e){let t=[];return e.map((e=>{let a={};a={name:e.inputName,required:e.isRequired,default:e.inputDefault,description:e.inputDesc},t.push(a)})),t}var Ie=a(6554);const Ne=({data:e})=>{const[t,a]=(0,p.useState)(!0),[n,l]=(0,p.useState)(!0),[r,o]=(0,p.useState)([]),[i,s]=(0,p.useState)(!0),[c,m]=(0,p.useState)(!1),[d,u]=(0,p.useState)(!1),[f,v]=(0,p.useState)(!1),[x,_]=(0,p.useState)(!1),R=(0,E.useDispatch)(),{registrationUrl:I,algoName:N,repoBranch:C,algorithmRegistrationError:S,algorithmYmlFilePath:D,repoRunCommand:b,algoResource:M,algoContainer:k}=(0,E.useSelector)(y),{setAlgoDesc:O,setAlgoDiskSpace:L,setAlgoName:B,setAlgoResource:j,setAlgoContainerURL:G,setRepoBranch:U,setRepoRunCommand:F,setRepoBuildCommand:V,setRepoUrl:H}=A,z=()=>m(!1);return(0,p.useEffect)((()=>{f&&(h.Notification.success("Algorithm "+N+": "+C+" was successfully submitted.",{autoClose:5e3,actions:[{label:"View algorithm registration progress here",callback:e=>{e.preventDefault(),window.open(I,"_blank","noreferrer")},displayType:"link"}]}),v(!1))}),[f]),g().createElement(g().Fragment,null,g().createElement(T.Form,{onSubmit:async function(e){e.preventDefault();let t=await async function(){const e=P.getState().Algorithm;let t=_e().load('\n  algorithm_name: algorithm-name\n  algorithm_version: 0.1.0\n  repository_url: https://github.com/\n  docker_container_url: url\n  algorithm_description: "Description of algorithm."\n  run_command: run.sh\n  build_command: build.sh\n  disk_space: 50GB\n  queue: queue\n  inputs:\n    file:\n      - name: benthic_reflectance_dataset\n        required: True\n      - name: depth_dataset\n        required: True\n    config:\n      - name: crid\n        default: "000"\n    positional:\n      - name: crid\n        default: "000"\n');t.algorithm_description=e.algoDesc,t.algorithm_name=e.algoName,t.algorithm_version=e.repoBranch,t.disk_space=e.algoDiskSpace+"GB",t.docker_container_url=e.algoContainer.value,t.repository_url=e.repoUrl,t.run_command=e.repoRunCommand,t.build_command=e.repoBuildCommand,t.queue=e.algoResource.value,t.inputs.file=Re(e.fileData),t.inputs.config=Re(e.configData),t.inputs.positional=Re(e.positionalData),console.log("Algo config:");let a=JSON.stringify(t),n=await async function(e,t){const a=await async function(e,t,a){var n=new URL(Q.PageConfig.getBaseUrl()+"jupyter-server-extension/createFile");console.log(n.href),n.searchParams.append("fileName",e),n.searchParams.append("pathName",a),n.searchParams.append("data",t);try{const e=await fetch(n.href,{headers:{"Content-Type":"application/json"}});if(!e.ok)throw new Error("Request failed");return console.log("resolved"),await e.json()}catch(e){console.log("error in new endpoint"),console.log(e)}}(e,t,"algorithm-configs");if(console.log(a),P.dispatch(w.actions.setAlgorithmYmlFilePath(a.file)),a){console.log("submitting register");const e=await async function(e){console.log("registering...."),console.log("register using file");var t=new URL(Q.PageConfig.getBaseUrl()+"jupyter-server-extension/registerUsingFile");console.log(t.href),t.searchParams.append("file",e);try{const e=await fetch(t.href,{headers:{"Content-Type":"application/json"}});if(!e.ok)throw new Error("Request failed");return console.log("resolved register request"),await e.json()}catch(e){return console.log("error in new register endpoint"),console.log(e),P.dispatch(w.actions.setAlgorithmRegistrationError(e.toString())),!1}}(a.file);if(!e)return!1;const t=JSON.parse(e.response);return console.log(t),console.log(t.message.job_web_url),t.message.job_web_url}}(t.algorithm_name+".yml",a);return!!n&&(console.log(n),P.dispatch(w.actions.setRegistrationUrl(n)),!0)}();t?(_(!0),v(!0)):_(!1),m(!0)}},g().createElement("div",{className:"section-padding"},g().createElement("h2",null,"Register Algorithm"),g().createElement(T.Alert,{variant:"primary",className:"alert-box"},"To register an algorithm to the MAAP, your code must be committed to a public code repository.",g().createElement("br",null),g().createElement("br",null),"Need more tips and tricks? Documentation may be found ",g().createElement("a",{href:"https://docs.maap-project.org/en/latest/system_reference_guide/algorithm_registration.html",target:"_blank"},"here"),"."),g().createElement("h3",null,"Repository Information"),g().createElement(T.Table,{className:"form-table"},g().createElement("tbody",null,g().createElement("tr",null,g().createElement("td",null,"Repository URL"),g().createElement("td",{className:"flex"},g().createElement("div",null,g().createElement("div",{className:"flex"},g().createElement(T.Form.Control,{onChange:e=>{R(H(e.target.value))},onKeyDown:e=>{13===e.keyCode&&e.target.blur()},onBlur:e=>{!async function(e){try{const t=await fetch(e,{method:"HEAD"});if(t.ok)return console.log(`URL "${e}" exists.`),!0;console.log(`URL "${e}" returned status code ${t.status}.`)}catch(e){return console.error("Error checking URL existence:",e),!1}return!1}(e.target.value)?l(!1):l(!0),s(!1)},type:"text",placeholder:"Enter repository URL"}),g().createElement("div",{className:i?"hide":"show"},n?g().createElement(X.mcb,{className:"success-icon"}):g().createElement(X.wrV,{className:"danger-icon"}))),g().createElement("div",{className:t?i?"hide":"show":"hide"})))),g().createElement("tr",null,g().createElement("td",null,"Repository Branch"),g().createElement("td",null,g().createElement(T.Form.Control,{type:"text",placeholder:"Enter repository branch",onChange:e=>{R(U(e.target.value))}}))),g().createElement("tr",null,g().createElement("td",null,"Run Command"),g().createElement("td",null,g().createElement(T.Form.Control,{type:"text",placeholder:"Enter run command",onChange:e=>{R(F(e.target.value))}}))),g().createElement("tr",null,g().createElement("td",null,"Build Command"),g().createElement("td",null,g().createElement(T.Form.Control,{type:"text",placeholder:"Enter build command",onChange:e=>{R(V(e.target.value))}})))))),g().createElement("div",{className:"section-padding"},g().createElement("h3",null,"General Information"),g().createElement(T.Table,{className:"form-table"},g().createElement("tbody",null,g().createElement("tr",null,g().createElement("td",null,"Algorithm Name"),g().createElement("td",null,g().createElement(T.Form.Control,{type:"text",placeholder:"Enter algorithm name",onChange:e=>{R(B(e.target.value))}}))),g().createElement("tr",null,g().createElement("td",null,"Algorithm Description"),g().createElement("td",null,g().createElement(T.Form.Control,{type:"textarea",placeholder:"Enter algorithm description",onChange:e=>{R(O(e.target.value))}}))),g().createElement("tr",null,g().createElement("td",null,"Disk Space (GB)"),g().createElement("td",null,g().createElement(T.Form.Control,{type:"text",placeholder:"Enter disk space",onChange:e=>{R(L(e.target.value))}}))),g().createElement("tr",null,g().createElement("td",null,"Resource Allocation"),g().createElement("td",null,g().createElement(T.Form.Group,{className:"mb-3 algorithm-input"},g().createElement(Ie.A,{cacheOptions:!0,defaultOptions:!0,value:M,loadOptions:ee,onChange:e=>{R(j(e))},placeholder:"Select resource"})))),g().createElement("tr",null,g().createElement("td",null,"Container URL"),g().createElement("td",null,g().createElement(Ie.A,{cacheOptions:!0,defaultOptions:!0,value:k,loadOptions:te,onChange:e=>{R(G(e))}}))))),g().createElement("div",{className:"section-padding"},g().createElement("h3",null,"Inputs"),g().createElement(Ae,null),g().createElement(ye,null)),g().createElement(T.Button,{variant:"primary",type:"submit"},"Register Algorithm"))),g().createElement("div",null,g().createElement(T.Modal,{show:c,"aria-labelledby":"contained-modal-title-vcenter",onHide:z},x?g().createElement("div",null,g().createElement(T.Modal.Header,{closeButton:!0},g().createElement(T.Modal.Title,null,"Algorithm submitted for registration")),g().createElement(T.Modal.Body,null,g().createElement(T.Modal.Title,null,N,": ",C),g().createElement("br",null),"Your algorithm was submitted for registration. You can view the progress here: ",g().createElement("a",{href:I,target:"_blank"},I),g().createElement("br",null),g().createElement("br",null),"A yml file with the algorithm configuration has been created in your workspace: ",D)):g().createElement("div",null,g().createElement(T.Modal.Header,{closeButton:!0},g().createElement(T.Modal.Title,null,"Algorithm failed to submit for registration")),g().createElement(T.Modal.Body,null,"Error Message: ",S)),g().createElement(T.Modal.Footer,null,g().createElement(T.Button,{variant:"primary",onClick:z},"Close")))))};class Ce extends h.ReactWidget{jupyterApp;constructor(e){super(),this.addClass(r.EXTENSION_CSS_CLASSNAME),this.jupyterApp=e}render(){return g().createElement(E.Provider,{store:P},g().createElement(se,{jupyterApp:this.jupyterApp}))}}class Se extends h.ReactWidget{data;constructor(e){super(),this.addClass(r.EXTENSION_CSS_CLASSNAME),this.data=e}render(){return g().createElement(E.Provider,{store:P},g().createElement(Ne,{data:this.data}))}}var De=a(4738);const be=[{id:"algorithms-menu",autoStart:!0,requires:[d.IMainMenu],activate:(e,t)=>{const{commands:a}=e;let n=new u.Menu({commands:a});n.id="algorithms-menu",n.title.label="Algorithms",[r.REGISTER_ALGORITHM_OPEN_COMMAND].forEach((e=>{n.addItem({command:e})})),t.addMenu(n)}},{id:r.VIEW_ALGORITHMS_PLUGIN_ID,autoStart:!0,optional:[n.ILauncher,h.ICommandPalette,De.ILayoutRestorer],activate:(e,t,a,n)=>{const{commands:o}=e,i=r.VIEW_ALGORITHMS_OPEN_COMMAND;let s=null;const c=new h.WidgetTracker({namespace:"view-algorithms-tracker"});n&&n.restore(c,{command:r.VIEW_ALGORITHMS_OPEN_COMMAND,name:()=>"view-algorithms-tracker"}),o.addCommand(i,{caption:r.VIEW_ALGORITHMS_NAME,label:r.VIEW_ALGORITHMS_NAME,icon:e=>e.isPalette?null:l.treeViewIcon,execute:()=>{const t=new Ce(e);s=new h.MainAreaWidget({content:t}),s.title.label=r.VIEW_ALGORITHMS_NAME,s.title.icon=l.treeViewIcon,e.shell.add(s,"main"),c.save(s),c.add(s)}}),console.log("JupyterLab MAAP Algorithms Registration extension is activated!")}},{id:r.REGISTER_ALGORITHM_PLUGIN_ID,autoStart:!0,optional:[n.ILauncher,h.ICommandPalette,De.ILayoutRestorer],activate:(e,t,a,n)=>{const{commands:o}=e,i=r.REGISTER_ALGORITHM_OPEN_COMMAND;let s=null;const c=new h.WidgetTracker({namespace:"register-algorithms-tracker"});n&&n.restore(c,{command:r.REGISTER_ALGORITHM_OPEN_COMMAND,name:()=>"register-algorithms-tracker"}),o.addCommand(i,{caption:r.REGISTER_ALGORITHM_NAME,label:r.REGISTER_ALGORITHM_NAME,icon:e=>e.isPalette?null:l.treeViewIcon,execute:t=>{console.log("Data coming in: "),console.log(t);const a=new Se(t);s=new h.MainAreaWidget({content:a}),s.title.label=r.REGISTER_ALGORITHM_NAME,s.title.icon=l.treeViewIcon,e.shell.add(s,"main"),c.save(s),c.add(s)}}),t&&t.add({command:i,category:"MAAP Extensions"}),a.addItem({command:r.REGISTER_ALGORITHM_OPEN_COMMAND,category:"MAAP Extensions"}),console.log("JupyterLab register-algorithm plugin is activated!")}}]},5443:(e,t,a)=>{a.d(t,{A:()=>i});var n=a(1601),l=a.n(n),r=a(6314),o=a.n(r)()(l());o.push([e.id,".action-bar {\n    display: flex;\n    flex-direction: row-reverse;\n    margin: 1rem;\n}",""]);const i=o},3385:e=>{e.exports="data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%27-4 -4 8 8%27%3e%3ccircle r=%272%27 fill=%27%23fff%27/%3e%3c/svg%3e"},5782:e=>{e.exports="data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%27-4 -4 8 8%27%3e%3ccircle r=%273%27 fill=%27%2386b7fe%27/%3e%3c/svg%3e"},4718:e=>{e.exports="data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%27-4 -4 8 8%27%3e%3ccircle r=%273%27 fill=%27%23fff%27/%3e%3c/svg%3e"},7154:e=>{e.exports="data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%27-4 -4 8 8%27%3e%3ccircle r=%273%27 fill=%27rgba%280, 0, 0, 0.25%29%27/%3e%3c/svg%3e"},8734:e=>{e.exports="data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%27-4 -4 8 8%27%3e%3ccircle r=%273%27 fill=%27rgba%28255, 255, 255, 0.25%29%27/%3e%3c/svg%3e"},5372:e=>{e.exports="data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 12 12%27 width=%2712%27 height=%2712%27 fill=%27none%27 stroke=%27%23dc3545%27%3e%3ccircle cx=%276%27 cy=%276%27 r=%274.5%27/%3e%3cpath stroke-linejoin=%27round%27 d=%27M5.8 3.6h.4L6 6.5z%27/%3e%3ccircle cx=%276%27 cy=%278.2%27 r=%27.6%27 fill=%27%23dc3545%27 stroke=%27none%27/%3e%3c/svg%3e"},7249:e=>{e.exports="data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 16 16%27 fill=%27%23000%27%3e%3cpath d=%27M.293.293a1 1 0 0 1 1.414 0L8 6.586 14.293.293a1 1 0 1 1 1.414 1.414L9.414 8l6.293 6.293a1 1 0 0 1-1.414 1.414L8 9.414l-6.293 6.293a1 1 0 0 1-1.414-1.414L6.586 8 .293 1.707a1 1 0 0 1 0-1.414z%27/%3e%3c/svg%3e"},6690:e=>{e.exports="data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 16 16%27 fill=%27%236ea8fe%27%3e%3cpath fill-rule=%27evenodd%27 d=%27M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z%27/%3e%3c/svg%3e"},5932:e=>{e.exports="data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 16 16%27 fill=%27%23fff%27%3e%3cpath d=%27M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z%27/%3e%3c/svg%3e"},1144:e=>{e.exports="data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 16 16%27 fill=%27%23fff%27%3e%3cpath d=%27M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z%27/%3e%3c/svg%3e"},7210:e=>{e.exports="data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 16 16%27 fill=%27none%27 stroke=%27%23052c65%27 stroke-linecap=%27round%27 stroke-linejoin=%27round%27%3e%3cpath d=%27M2 5L8 11L14 5%27/%3e%3c/svg%3e"},7326:e=>{e.exports="data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 16 16%27 fill=%27none%27 stroke=%27%23212529%27 stroke-linecap=%27round%27 stroke-linejoin=%27round%27%3e%3cpath d=%27M2 5L8 11L14 5%27/%3e%3c/svg%3e"},5531:e=>{e.exports="data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 16 16%27%3e%3cpath fill=%27none%27 stroke=%27%23343a40%27 stroke-linecap=%27round%27 stroke-linejoin=%27round%27 stroke-width=%272%27 d=%27m2 5 6 6 6-6%27/%3e%3c/svg%3e"},7115:e=>{e.exports="data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 16 16%27%3e%3cpath fill=%27none%27 stroke=%27%23dee2e6%27 stroke-linecap=%27round%27 stroke-linejoin=%27round%27 stroke-width=%272%27 d=%27m2 5 6 6 6-6%27/%3e%3c/svg%3e"},4274:e=>{e.exports="data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 20 20%27%3e%3cpath fill=%27none%27 stroke=%27%23fff%27 stroke-linecap=%27round%27 stroke-linejoin=%27round%27 stroke-width=%273%27 d=%27M6 10h8%27/%3e%3c/svg%3e"},5419:e=>{e.exports="data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 20 20%27%3e%3cpath fill=%27none%27 stroke=%27%23fff%27 stroke-linecap=%27round%27 stroke-linejoin=%27round%27 stroke-width=%273%27 d=%27m6 10 3 3 6-6%27/%3e%3c/svg%3e"},6366:e=>{e.exports="data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 30 30%27%3e%3cpath stroke=%27rgba%28255, 255, 255, 0.55%29%27 stroke-linecap=%27round%27 stroke-miterlimit=%2710%27 stroke-width=%272%27 d=%27M4 7h22M4 15h22M4 23h22%27/%3e%3c/svg%3e"},2247:e=>{e.exports="data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 30 30%27%3e%3cpath stroke=%27rgba%2833, 37, 41, 0.75%29%27 stroke-linecap=%27round%27 stroke-miterlimit=%2710%27 stroke-width=%272%27 d=%27M4 7h22M4 15h22M4 23h22%27/%3e%3c/svg%3e"},8487:e=>{e.exports="data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 8 8%27%3e%3cpath fill=%27%23198754%27 d=%27M2.3 6.73.6 4.53c-.4-1.04.46-1.4 1.1-.8l1.1 1.4 3.4-3.8c.6-.63 1.6-.27 1.2.7l-4 4.6c-.43.5-.8.4-1.1.1z%27/%3e%3c/svg%3e"}}]);
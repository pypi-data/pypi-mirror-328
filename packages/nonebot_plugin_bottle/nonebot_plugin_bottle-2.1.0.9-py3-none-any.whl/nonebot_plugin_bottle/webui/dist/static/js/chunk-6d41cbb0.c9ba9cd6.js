(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6d41cbb0"],{"076c":function(t,e,n){"use strict";n("1b05")},"189a":function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("el-row",{staticStyle:{margin:"20px"},attrs:{gutter:20}},t._l(t.bottles,(function(e){return n("el-col",{key:e.id,attrs:{span:6}},[n("el-card",{staticClass:"bottle-card",attrs:{shadow:"hover"},nativeOn:{click:function(n){return t.showDetails(e)}},scopedSlots:t._u([{key:"header",fn:function(){return[n("div",{staticClass:"header-container"},[n("span",{staticClass:"bottle-id"},[t._v(t._s(e.id))]),n("span",{staticClass:"group-name"},[t._v(t._s(e.group_name)+"("+t._s(e.group_id)+")"),n("br"),n("i",{staticClass:"el-icon-user"}),t._v(t._s(e.user_name)+"("+t._s(e.user_id)+")")])])]},proxy:!0}],null,!0)},[n("div",{domProps:{innerHTML:t._s(t.sanitizedContent(e.content))}}),n("div",{staticClass:"bottle-info-icon-container"},[n("el-tag",[t._v(" 👍 "+t._s(e.like)+" ")]),n("el-tag",{attrs:{type:"warning"}},[t._v(" 🤚 "+t._s(e.picked))]),n("el-tag",{attrs:{type:"danger"}},[t._v(" 🚩 "+t._s(e.report))])],1),n("div",{staticStyle:{"text-align":"center","margin-top":"10px"}},[n("el-button",{attrs:{type:"success"},on:{click:function(n){return n.stopPropagation(),t.approveBottle(e.id)}}},[t._v(" 通过 ")]),n("el-button",{attrs:{type:"danger"},on:{click:function(n){return n.stopPropagation(),t.rejectBottle(e.id)}}},[t._v(" 拒绝 ")])],1)])],1)})),1),n("div",{staticStyle:{"margin-top":"20px","text-align":"center"}},[n("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:t.total,"page-size":t.pageSize},on:{"current-change":t.handlePageChange}})],1),n("el-dialog",{attrs:{visible:t.dialogVisible,width:"50%",title:t.selectedBottle?"漂流瓶 "+t.selectedBottle.id:"","custom-class":"bottle-dialog"},on:{"update:visible":function(e){t.dialogVisible=e}}},[t.selectedBottle?n("div",[n("p",[n("strong",[t._v("群:")]),t._v(" "+t._s(t.selectedBottle.group_name)+"("+t._s(t.selectedBottle.group_id)+") ")]),n("p",[n("strong",[t._v("用户:")]),t._v(" "+t._s(t.selectedBottle.user_name)+"("+t._s(t.selectedBottle.user_id)+") ")]),n("div",{domProps:{innerHTML:t._s(t.sanitizedContent(t.selectedBottle.content))}}),n("div",{staticClass:"bottle-info-icon-container"},[n("el-tag",[t._v(" 👍 "+t._s(t.selectedBottle.like)+" ")]),n("el-tag",{attrs:{type:"warning"}},[t._v(" 🤚 "+t._s(t.selectedBottle.picked))]),n("el-tag",{attrs:{type:"danger"}},[t._v(" 🚩 "+t._s(t.selectedBottle.report))])],1)]):t._e(),n("div",{staticStyle:{"text-align":"center","margin-top":"20px"}},[n("el-button",{attrs:{type:"success"},on:{click:function(e){return t.approveBottle(t.selectedBottle.id)}}},[t._v(" 通过 ")]),n("el-button",{attrs:{type:"danger"},on:{click:function(e){return t.rejectBottle(t.selectedBottle.id)}}},[t._v(" 拒绝 ")]),n("el-button",{on:{click:t.showNextBottle}},[t._v("下一条")])],1)])],1)},s=[],o=n("0fc4"),a=n("7921"),i=(n("4437"),n("701d"),n("36f7"),n("b775"));function c(t){return Object(i["a"])({url:"api/getUnApprovedBottle",method:"get",params:t})}function l(t){return Object(i["a"])({url:"api/approve",method:"post",data:{bottle_id:t}})}function u(t){return Object(i["a"])({url:"api/reject",method:"post",data:{bottle_id:t}})}var d=n("e382"),p=n.n(d),g={data:function(){return{bottles:[],total:0,pageSize:10,currentPage:1,dialogVisible:!1,selectedBottle:null}},mounted:function(){this.fetchBottles()},methods:{sanitizedContent:function(t){return p.a.sanitize(t)},fetchBottles:function(){var t=this;return Object(a["a"])(Object(o["a"])().mark((function e(){var n;return Object(o["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c({page:t.currentPage-1,page_size:t.pageSize});case 3:n=e.sent,t.bottles=n.bottles,t.total=n.total,e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),console.error("Error fetching bottles:",e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))()},handlePageChange:function(t){this.currentPage=t,this.fetchBottles()},showDetails:function(t){this.selectedBottle=t,this.dialogVisible=!0},approveBottle:function(t){var e=this;return Object(a["a"])(Object(o["a"])().mark((function n(){var r;return Object(o["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,l(t);case 3:r=n.sent,0===r.code?(e.$message.success(r.msg),e.removeBottle(t),e.showNextBottle()):e.$message.error(r.msg),n.next=11;break;case 7:n.prev=7,n.t0=n["catch"](0),console.error("Error approving bottle:",n.t0),e.$message.error("操作失败");case 11:case"end":return n.stop()}}),n,null,[[0,7]])})))()},rejectBottle:function(t){var e=this;return Object(a["a"])(Object(o["a"])().mark((function n(){var r;return Object(o["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,u(t);case 3:r=n.sent,0===r.code?(e.$message.success(r.msg),e.removeBottle(t),e.showNextBottle()):e.$message.error(r.msg),n.next=11;break;case 7:n.prev=7,n.t0=n["catch"](0),console.error("Error rejecting bottle:",n.t0),e.$message.error("操作失败");case 11:case"end":return n.stop()}}),n,null,[[0,7]])})))()},removeBottle:function(t){this.bottles=this.bottles.filter((function(e){return e.id!==t}))},showNextBottle:function(){var t=this;if(!1!==this.dialogVisible){var e=this.bottles.findIndex((function(e){return e.id===t.selectedBottle.id})),n=this.bottles[e+1]||this.bottles[0]||null;n?this.showDetails(n):this.dialogVisible=!1}}}},v=g,f=(n("076c"),n("6a6f"),n("c4f6")),b=Object(f["a"])(v,r,s,!1,null,"805ec1b6",null);e["default"]=b.exports},"1b05":function(t,e,n){},"6a6f":function(t,e,n){"use strict";n("eb0f")},"701d":function(t,e,n){"use strict";var r=n("fa34"),s=n("8ecd").findIndex,o=n("8d05"),a="findIndex",i=!0;a in[]&&Array(1)[a]((function(){i=!1})),r({target:"Array",proto:!0,forced:i},{findIndex:function(t){return s(this,t,arguments.length>1?arguments[1]:void 0)}}),o(a)},eb0f:function(t,e,n){}}]);
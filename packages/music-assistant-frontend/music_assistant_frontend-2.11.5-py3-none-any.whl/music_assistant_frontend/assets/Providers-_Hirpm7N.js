import{Q as R,x as D,c as Y,a4 as i,aS as X,b as z,w as O,Z as y,$ as M,a0 as a,bT as f,G as V,S as r,bo as j,B as l,R as m,a9 as b,U as o,am as F,a7 as G,X as Q,D as T,al as _,aa as u,a8 as c,W as g,ak as P,bU as W,a3 as Z}from"./index-B1-NcwUi.js";import{_ as N}from"./ProviderIcon.vue_vue_type_style_index_0_lang-CSrzXWJm.js";import{L as q,B as k}from"./ListItem-6jrqendR.js";import{C as H}from"./Container-DM1rL0ee.js";import{a as J}from"./VBtn-bKB7410c.js";import{V as K}from"./VToolbar-ZYKrVnx8.js";import{V as B}from"./VAlert-amXXO5IX.js";import{_ as ee}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./VContainer-CUL0yimr.js";/* empty css              */const ne={class:"line-clamp-1"},te={class:"line-clamp-1"},ie=R({__name:"Providers",setup(ae){const C=j(),p=D([]),x=Y(()=>Object.values(i.providerManifests).filter(t=>t.multi_instance||!p.value.find(n=>n.domain==t.domain)).sort((t,n)=>(t.name||i.providerManifests[t.domain].name).toUpperCase()>(n.name||i.providerManifests[n.domain].name).toUpperCase()?1:-1)),I=i.subscribe(X.PROVIDERS_UPDATED,()=>{h()});z(I);const h=async function(){p.value=await i.getProviderConfigs()},U=function(t){i.removeProviderConfig(t),p.value=p.value.filter(n=>n.instance_id!=t)},w=function(t){C.push(`/settings/editprovider/${t}`)},$=function(t){if(t.depends_on&&!i.getProvider(t.depends_on)){const n=i.getProviderName(t.depends_on);confirm(c("settings.provider_depends_on_confirm",[t.name,n]))&&C.push(`/settings/addprovider/${t.depends_on}`);return}C.push(`/settings/addprovider/${t.domain}`)},S=function(t){t.enabled=!t.enabled,i.saveProviderConfig(t.domain,{enabled:t.enabled},t.instance_id)},E=function(t){i.sendCommand("config/providers/reload",{instance_id:t}).catch(n=>alert(n))},L=function(t,n){var e;const d=[{label:"settings.configure",labelArgs:[],action:()=>{w(n.instance_id)},icon:"mdi-cog"},{label:n.enabled?"settings.disable":"settings.enable",labelArgs:[],action:()=>{S(n)},icon:"mdi-cancel",disabled:!i.providerManifests[n.domain].allow_disable},{label:"settings.documentation",labelArgs:[],action:()=>{W(i.providerManifests[n.domain].documentation)},icon:"mdi-bookshelf",disabled:!i.providerManifests[n.domain].documentation},{label:"settings.sync",labelArgs:[],action:()=>{i.startSync(void 0,[n.instance_id])},icon:"mdi-sync",hide:!((e=i.providers[n.instance_id])!=null&&e.available)||n.type!=f.MUSIC},{label:"settings.delete",labelArgs:[],action:()=>{U(n.instance_id)},icon:"mdi-delete",hide:i.providerManifests[n.domain].builtin},{label:"settings.reload",labelArgs:[],action:()=>{E(n.instance_id)},icon:"mdi-refresh"}];Z.emit("contextmenu",{items:d,posX:t.clientX,posY:t.clientY})};return O(()=>i.providers,t=>{t&&h()},{immediate:!0}),(t,n)=>(r(!0),y(V,null,M(a(f),d=>(r(),y("div",{key:d,style:{"margin-bottom":"10px"}},[l(K,{color:"transparent",density:"compact",class:"titlebar"},{title:o(()=>[_(u(a(c)(`settings.${d}providers`)),1)]),append:o(()=>[x.value.filter(e=>e.type==d).length?(r(),m(F,{key:0,scrim:""},{activator:o(({props:e})=>[l(J,T({ref_for:!0},e,{color:"accent",variant:"outlined"}),{default:o(()=>[_(u(a(c)("settings.add_new_provider_button",[d])),1)]),_:2},1040)]),default:o(()=>[l(G,{density:"compact"},{default:o(()=>[(r(!0),y(V,null,M(x.value.filter(e=>e.type==d),e=>(r(),m(Q,{key:e.domain,style:{"padding-top":"0","padding-bottom":"0","margin-bottom":"0"},title:e.name,onClick:s=>$(e)},{prepend:o(()=>[l(N,{domain:e.domain,size:26,class:"media-thumb",style:{"margin-left":"10px"}},null,8,["domain"])]),_:2},1032,["title","onClick"]))),128))]),_:2},1024)]),_:2},1024)):b("",!0)]),_:2},1024),d==a(f).MUSIC&&p.value.filter(e=>e.type==a(f).MUSIC&&e.domain in a(i).providerManifests&&e.domain!=="builtin").length==0?(r(),m(B,{key:0,border:"top","border-color":"warning",style:{margin:"20px"},icon:"mdi-alert-box-outline"},{default:o(()=>[g("b",null,u(a(c)("settings.no_music_providers_detail")),1),n[0]||(n[0]=g("br",null,null,-1)),_(" "+u(a(c)("settings.no_music_providers_detail")),1)]),_:1})):b("",!0),d==a(f).PLAYER&&p.value.filter(e=>e.type==a(f).PLAYER&&e.domain in a(i).providerManifests).length==0?(r(),m(B,{key:1,border:"top","border-color":"warning",style:{margin:"20px"},icon:"mdi-alert-box-outline"},{default:o(()=>[g("b",null,u(a(c)("settings.no_player_providers_detail")),1),n[1]||(n[1]=g("br",null,null,-1)),_(" "+u(a(c)("settings.no_player_providers_detail")),1)]),_:1})):b("",!0),l(H,null,{default:o(()=>[(r(!0),y(V,null,M(p.value.filter(e=>e.type==d).sort((e,s)=>{var v,A;return(e.name||((v=a(i).getProvider(e.instance_id))==null?void 0:v.name)||a(i).getProviderName(e.domain)).localeCompare(s.name||((A=a(i).getProvider(s.instance_id))==null?void 0:A.name)||a(i).getProviderName(s.domain))}),e=>(r(),m(q,{key:e.instance_id,"show-menu-btn":"",link:"",onMenu:s=>L(s,e),onClick:s=>w(e.instance_id)},{prepend:o(()=>[l(N,{domain:e.domain,size:50,class:"listitem-media-thumb",style:{"margin-top":"5px","margin-bottom":"5px"}},null,8,["domain"])]),title:o(()=>{var s;return[g("div",ne,u(e.name||((s=a(i).getProvider(e.instance_id))==null?void 0:s.name)||a(i).getProviderName(e.domain)),1)]}),subtitle:o(()=>[g("div",te,u(a(i).providerManifests[e.domain].description),1)]),append:o(()=>{var s;return[a(i).syncTasks.value.filter(v=>v.provider_instance==e.instance_id).length>0?(r(),m(k,{key:0,icon:"",title:a(c)("settings.sync_running")},{default:o(()=>[l(P,{color:"grey"},{default:o(()=>n[2]||(n[2]=[_(" mdi-sync ")])),_:1})]),_:1},8,["title"])):b("",!0),e.enabled?e.last_error?(r(),m(k,{key:2,icon:"",title:e.last_error},{default:o(()=>[l(P,{color:"red"},{default:o(()=>n[4]||(n[4]=[_(" mdi-alert-circle ")])),_:1})]),_:2},1032,["title"])):(s=a(i).providers[e.instance_id])!=null&&s.available?b("",!0):(r(),m(k,{key:3,icon:"",title:a(c)("settings.not_loaded")},{default:o(()=>[l(P,{icon:"mdi-timer-sand"})]),_:1},8,["title"])):(r(),m(k,{key:1,icon:"",title:a(c)("settings.provider_disabled")},{default:o(()=>[l(P,{color:"grey"},{default:o(()=>n[3]||(n[3]=[_(" mdi-cancel ")])),_:1})]),_:1},8,["title"]))]}),_:2},1032,["onMenu","onClick"]))),128))]),_:2},1024)]))),128))}}),fe=ee(ie,[["__scopeId","data-v-440e50ee"]]);export{fe as default};

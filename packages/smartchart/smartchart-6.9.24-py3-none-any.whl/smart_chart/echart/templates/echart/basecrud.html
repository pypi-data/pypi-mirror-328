<!doctype html><html><head><title>{{title}}</title><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0,viewport-fit=cove"><meta http-equiv="X-UA-Compatible" content="IE=edge">{{contentrefresh|safe}}
<link rel="icon"  href="/static/smartui/img/favicon.ico"><link rel="stylesheet" href="/static/smartchart/js/fun.css?_=1"><script src="/static/smartchart/js/jquery-2.2.3.min.js"></script>
{% if devhead %}<link rel="stylesheet" href="/static/smartchart/js/dev.css?_=3.1"><link rel="stylesheet" href="/static/smartchart/icon/iconfont.css?_=2"><link rel="stylesheet" href="/static/smartchart/editor/modal.css">{% endif %}
<script src="/static/smartui/js/vue.min.js"></script><link rel="stylesheet" href="/static/smartui/elementui/theme-chalk/index.css"><script src="/static/smartui/elementui/index.js"></script><link rel="stylesheet" href="/static/smartchart/js/crud.css?_=1">
{% block head %}{% endblock %}</head>
{% autoescape off %}{{linkhead}}{{devhead}}{% block body %}
<body><vue id="vue_app" v-loading.fullscreen.lock="!startRender">{% for div in div_list %}{{div}}{% endfor %}<vue id="crud_body" :class="smtdrag?'smtdrag':''"> {% block body_search %}<div class="search_base_div" v-if="searchHead" ><div class="search_div"><div style="display:flex;" v-if="startRender" id="partSearch"></div></div></div>{% endblock %}{% block body_addHead %}<div class="search_base_div" v-if="addHead&&Object.keys(form).length>0"><div class="search_div"><div style="display:flex;" v-if="startRender"><el-form ref="form" :model="form" :rules="rules" :label-width="formLabelWidth" :inline="true" size="mini" id="modifyForm1"></el-form></div></div></div>{% endblock %}{% block body_extHead %}{% endblock %} <div class="body_base_div"><div class="body_div" v-if="startRender"><div class="filter_base_div"><div class="filter_div"><span class="title">{[title]}</span><div> {% block body_filter %}<template v-if="!searchHead" id="partSearch"></template>{% endblock %} <template v-for="(value, key) in filterDict"><el-date-picker v-if="typeDict[key]=='date'" v-model="filterDict[key]" type="date" size="mini" :style="{width:inputWidth}" :placeholder="nameDict[key]||key" value-format="yyyy-MM-dd" clearable @change="data_filter()"></el-date-picker><el-date-picker v-else-if="typeDict[key]=='month'" v-model="filterDict[key]" type="month" size="mini" :style="{width:inputWidth}" :placeholder="nameDict[key]||key" value-format="yyyy-MM" clearable @change="data_filter()"></el-date-picker><el-select v-else-if="['select','selects','radio'].includes(typeDict[key])" :remote="remoteDsDict[key]" :remote-method="(q)=>{remoteMethod(q,key)}" :loading="loadingDict[key]" v-model="filterDict[key]" :style="{width:inputWidth}" :placeholder="nameDict[key]||key" size="mini" clearable filterable @change="data_filter()" ><el-option v-for="item in optionDict2[key]" :key="item[0]" :label="item[0]" :value="item[0]"></el-option></el-select><el-input v-else v-model="filterDict[key]" autocomplete="off" :placeholder="nameDict[key]||key" :style="{width:inputWidth}" size="mini" clearable @input='data_filter()'></el-input></template><el-popconfirm :title="'execute:'+value[0]+'?'" v-for="(value, key) in actionDict" @confirm='action_batch(key)'><el-button slot="reference" :disabled="isClicked" size="mini" :style="{background:value[1],border:'none',color:'#fff'}" >{[value[0]]}</el-button></el-popconfirm></div></div></div><div class="table_base_div"> {% block body_tree %} <div class="tree_div" v-if="tree_ds" :style="'width:'+treeWidth"><el-tree :data="tree_data" @node-click="handleNodeClick"></el-tree></div> {% endblock %} <div class="table_div" :style="'width:'+tableWidth"> {% block body_table %} <el-table :data="tableData" size="mini" :header-cell-style="{ background: tableHeaderColor}" :header-cell-class-name="tableHearderClassName" :row-class-name="tableRowClassName" :stripe="stripe" :show-summary="showSummary" border ref="multipleTable" :span-method="spanMethod" :max-height="maxheight" highlight-current-row @current-change="handleRowClickChange" @selection-change="handleSelectionChange" lazy :row-key="tree_id?'treeid':''" :load="loadTree" style="width: 100%;"><el-table-column type="expand" v-if="shortTableFields"><template slot-scope="scope"><el-descriptions :column="3" size="mini" border><el-descriptions-item v-for="item in (tableFields||tableHead)" :key="item" :label="nameDict[item]||item" ><el-tag v-if="tagFields.includes(item)" :color="statusColor[scope.row[item]]" style="color:black" disable-transitions size="mini">{[scope.row[item]]}</el-tag><el-image v-else-if="scope.row[item]&&typeDict[item]==='img'" :src="construct_img(scope.row[item])" style="width: 100px" :preview-src-list="[construct_img(scope.row[item])]" lazy></el-image><span v-else>{[scope.row[item]]}</span></el-descriptions-item></el-descriptions></template></el-table-column><el-table-column type="index" v-if="showIndex" width="50"></el-table-column><el-table-column type="selection" width="55" v-if="actionDict" key="1"></el-table-column> {% block body_table_columns %} <el-table-column v-for="item in (shortTableFields||tableFields||tableHead)" :label="nameDict[item]||item" :width="widthDict[item]" :align="alignDict[item]||'center'" :prop="item" :key="item" :sortable="!mergeFields" show-overflow-tooltip :fixed="fixedFields.includes(item)"><template slot-scope="scope" v-if="scope.row[item]"><span v-if="tagFields.includes(item)"><el-tag v-for="v in scope.row[item].split(',')" :color="statusColor[v]" style="color:black" disable-transitions>{[v]}</el-tag></span><el-image v-else-if="typeDict[item]==='img'" :src="construct_img(scope.row[item])" :preview-src-list="[construct_img(scope.row[item])]" lazy></el-image><el-link v-else-if="typeDict[item]==='file'" type="success" :href="construct_img(scope.row[item])" target="_blank">{[scope.row[item]]}</el-link> {% block body_table_column %}{% endblock %} <span v-else>{[ scope.row[item]]}</span></template></el-table-column> {% endblock %} <el-table-column :fixed="widthDict.OP?null:'right'" :label="nameDict.OP||'OP'" :width="widthDict.OP||80" v-if="btnEdit||btnRequest||btnView||delete_id" key="2"><template slot-scope="scope"><el-button type="text" size="mini" icon="el-icon-edit-outline" @click.stop="handleRequestClick(scope.row)" v-if="btnRequest"></el-button><el-button type="text" size="mini" icon="el-icon-edit" @click.stop="handleEditClick(scope.row)" v-if="btnEdit"></el-button><el-button type="text" size="mini" icon="el-icon-view" @click.stop="handleViewClick(scope.row)" v-if="btnView"></el-button><el-popconfirm title="确认删除?" @confirm='handleDeleteClick(scope.row)' v-if="delete_id"><el-button type="text" size="mini" icon="el-icon-delete" slot="reference"></el-button></el-popconfirm> {% block body_table_column_button %}{% endblock %} </template></el-table-column></el-table><el-pagination align='center' v-if="pageSize<999" @size-change="handlerSizeChange" @current-change="handlerCurrentChange" :current-page="currentPage" :page-size="pageSize" layout="total,sizes,prev,pager,next,jumper" :total="total"></el-pagination> {% endblock %} </div></div></div></div></vue> {% block dialog_modify %}<el-dialog :title="title" :visible.sync="dialogFormVisible" :width="dialogWidth" :fullscreen="dialogFull" center v-if="!addHead"><el-form ref="form" :model="form" :rules="rules" :label-width="formLabelWidth" id="modifyForm2"></el-form><div slot="footer" class="dialog-footer"><el-button @click="dialogFormVisible = false" icon="el-icon-circle-close"></el-button><el-button :disabled="isClicked" type="primary" @click.stop="update_data" icon="el-icon-success"></el-button></div></el-dialog>{% endblock %} {% block dialog_card %}<el-dialog :visible.sync="dialogTableVisible" :width="dialogWidth"><el-descriptions :column="3" size="mini" border><el-descriptions-item v-for="(value,item) in detail[0]" :key="item" :label="nameDict[item]||item"><el-tag v-if="tagFields.includes(item)" :color="statusColor[value]" style="color:black" disable-transitions size="mini">{[value]}</el-tag><el-image v-else-if="value&&typeDict[item]==='img'" :src="construct_img(value)" style="width: 100px" :preview-src-list="[construct_img(value)]" lazy></el-image><span v-else>{[value]}</span></el-descriptions-item></el-descriptions></el-dialog>{% endblock %} {% block dialog_request %}<el-dialog :title="title+':变更需求'" :visible.sync="dialogFormVisible_r" :width="dialogWidth"><el-form ref="rform" :model="rform" :rules="rules" :label-width="formLabelWidth"><el-form-item prop="code" label="主键" required><el-input v-model="rform.code" autocomplete="off" disabled></el-input></el-form-item><el-form-item prop="columnname" label="列名" required><el-select v-model="rform.columnname" @change="rform_select_change"><el-option v-for="(value, key) in nameDict" :key="key" :label="value" :value="key"></el-option></el-select></el-form-item><el-form-item prop="oldvalue" label="旧值"><el-input v-model="rform.oldvalue" autocomplete="off" disabled></el-input></el-form-item><el-form-item prop="newvalue" label="新值" required><el-input v-model.trim="rform.newvalue" autocomplete="off"></el-input></el-form-item><el-form-item prop="request_remark" label="备注"><el-input v-model="rform.request_remark" autocomplete="off"></el-input></el-form-item></el-form><div slot="footer" class="dialog-footer"><el-button @click="dialogFormVisible_r = false" icon="el-icon-circle-close"></el-button><el-button :disabled="isClicked" type="primary" @click.stop="update_data_r" icon="el-icon-success"></el-button></div></el-dialog>{% endblock %} {% if devhead %}<el-drawer title="CRUD设定" :visible.sync="dialogSetupVisible" direction="btt" :with-header="false" v-if="startRender" :modal="false" id="partSetup"></el-drawer>{% endif %}</vue></body>
{% endblock %}{% endautoescape %}
</html><script>const dashid={{ dashid }};const dsDict={{ dsdict|safe }};</script><script src="/static/smartchart/js/flexible.min.js"></script><script src="/static/smartchart/js/fun.js?_=5"></script>
{{footer|safe}}<script src="/static/smartchart/opt/smt_crud.js?_=1.4"></script>{% block javascript %}{% endblock %}{% if devhead %}<script src="/static/smartchart/js/cruddev.js?_=1.5"></script><div class="modal" id="modal_iframe"><div class="modal-content modal-dash"><header class="modal-header" id="id_header">
<span class="close" onclick="hideModal()">×</span>SmartChart<a class='iconfont iconed_ds' onclick=dev_dseditor()>数据集</a><a class='iconfont iconed_chart' onclick=dev_dschart()>图形</a><a class='iconfont iconed_div' onclick=dev_dsdiv()>布局</a>
    <span class="editor_head"></span></header><div class="modal-body"><iframe id="iframepage" class="iframechart"  width="100%"></iframe></div></div></div><script src="/static/smartchart/js/dev.js?_=8.1"></script>{% endif %}
<script>var charts = [];{{echart_main|safe}}window.onresize = function(){for(let i = 0; i < charts.length; i++){charts[i].resize();}};</script>
{% block footer %}{% endblock %}<script>vapp.refreshTable();vapp.transfer_config();vapp.startRender=true;</script>
<!--powered by smartchart.cn,Designed by JohnYan mailto:84345999@qq.com, https://gitee.com/smartchart/smartchart you need keep this-->